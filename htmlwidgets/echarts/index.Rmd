---
title: "echarts"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(echarts)
library(htmltools)
air <- read.csv('https://raw.githubusercontent.com/plotly/datasets/master/2011_february_us_airport_traffic.csv')
flights <- read.csv('https://raw.githubusercontent.com/plotly/datasets/master/2011_february_aa_flight_paths.csv')

# split large airports and smaller one
large_airports <- air[air$cnt > quantile(air$cnt, 0.90), ]
small_airports <- dplyr::anti_join(air, large_airports, by = "iata")

# split freuqent and less frequent flights
frequent <- flights[flights$cnt > quantile(flights$cnt, 0.90), ]
sparse <- flights[flights$cnt < quantile(flights$cnt, 0.90),]
```

```{r header}
# customise line effect
line.effect <- list(loop = TRUE,
                    show = TRUE,
                    scaleSize = 2,
                    period = 40,
                    shadowBlur = 5)

point.effect <- list(show = TRUE, shadowBlur = 10)
item.style <- list(normal = list(lineStyle = list(type = "dotted", shadowBlur = 2)))

large_airports %>% 
  echart(iata) %>% 
  emap(mapType = "world|United States of America") %>% 
  emap_coords(long, lat) %>% 
  emap_points(cnt, symbol = "emptyCircle", effect = point.effect) %>% 
  emap_lines(frequent, airport1, airport2, effect = line.effect) %>% 
  edata(small_airports, iata) %>% 
  emap(mapType = "world|United States of America") %>% 
  emap_coords(long, lat) %>% 
  emap_points(cnt, symbol = "circle", symbolSize = 2) %>% 
  emap_lines(sparse, airport1, airport2, itemStyle = item.style) %>% 
  etooltip() %>% 
  etheme("red")
```

```{r chart types}
div(class = "page-header",
    h2("Chart types"))
```

1. bar 
2. line
3. area
4. pie
5. heatmap
6. chord
7. venn
8. gauge
9. force network
10. word cloud

```{r install}
div(class = "page-header",
    h2("Install"))
```

```{r install code, eval=FALSE, echo=TRUE}
devtools::install_github("JohnCoene/echarts")
```

```{r first chart}
div(class = "page-header",
    h2("Your first chart"))
```

```{r first chart code, eval=TRUE, echo=TRUE}
mtcars %>% 
  echart(drat) %>% 
  ebar(qsec) %>% 
  eline(mpg) %>% 
  etooltip() %>% 
  etheme("macarons")
```

```{r Explanation}
div(class = "page-header",
    h2("How it works?"))
```

Initialise your chart with `echart` then add series, supports magrittr pipes, `%>%`.

