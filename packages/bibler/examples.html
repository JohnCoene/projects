<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title></title>

<script src="site_libs/htmlwidgets-0.8/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.7.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotlyjs-1.27.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotlyjs-1.27.1/plotly-latest.min.js"></script>
<meta http-equiv="Cache-control" content="public">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<!--Import materialize.css-->
<link type="text/css" rel="stylesheet" href="../../css/materialize.min.css"  media="screen,projection"/>

<link rel="stylesheet" href="../../css/atelier-cave-light.css">

<!--Let browser know website is optimized for mobile-->
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-74544116-1', 'auto');
  ga('send', 'pageview');

</script>

<!--SHARE TAGS-->
<meta name="google-site-verification" content="p4A9hVd1c8FOAlQsyDq0NMrE9IQdtfZoHgQ2e1t2dYE" />
<meta name="description" content="R, data, and other indoor stuff." />

<!-- Schema.org markup for Google+ -->
<meta itemprop="name" content="John Coene">
<meta itemprop="description" content="R, data, and other indoor stuff.">
<meta itemprop="image" content="http://john-coene.com/img/graphTweets.png">

<!-- Twitter Card data -->
<meta name="twitter:card" content="website">
<meta name="twitter:site" content="@jdatap">
<meta name="twitter:title" content="John Coene">
<meta name="twitter:description" content="R, data, and other indoor stuff.">
<meta name="twitter:creator" content="@jdatap">
<meta name="twitter:image" content="http://john-coene.com/img/graphTweets.png">

<!-- Open Graph data -->
<meta property="og:title" content="John Coene" />
<meta property="og:image" content="http://john-coene.com/img/graphTweets.png" />
<meta property="og:description" content="R, data, and other indoor stuff." />
<meta property="og:site_name" content="John Coene" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #dddddd; }
td.sourceCode { padding-left: 5px; }
code > span.kw { font-weight: bold; } /* Keyword */
code > span.dt { color: #800000; } /* DataType */
code > span.dv { color: #0000ff; } /* DecVal */
code > span.bn { color: #0000ff; } /* BaseN */
code > span.fl { color: #800080; } /* Float */
code > span.ch { color: #ff00ff; } /* Char */
code > span.st { color: #dd0000; } /* String */
code > span.co { color: #808080; font-style: italic; } /* Comment */
code > span.al { color: #00ff00; font-weight: bold; } /* Alert */
code > span.fu { color: #000080; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #ff0000; font-weight: bold; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #ff00ff; } /* SpecialChar */
code > span.vs { color: #dd0000; } /* VerbatimString */
code > span.ss { color: #dd0000; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { font-weight: bold; } /* Preprocessor */
code > span.at { } /* Attribute */
code > span.do { color: #808080; font-style: italic; } /* Documentation */
code > span.an { color: #808080; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #808080; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #808080; font-weight: bold; font-style: italic; } /* Information */
</style>



<link rel="stylesheet" href="../../css/styles.css" type="text/css" />

</head>

<body>


<nav>
  <div class="nav-wrapper blue">
    <div class = "container">
      <a href="/" class="brand-logo brand left">John Coene</a>
      <ul id="nav-mobile" class="right hide-on-med-and-down">
        <li><a href="https://github.com/JohnCoene/bibler/" target="_blank">Repository</a></li>
        <li><a href="examples">Examples</a></li>
      </ul>
    </div>
  </div>
</nav>





<main>
<div class="container">
<h1>bibler examples</h1>
<h3 id="preamble">Preamble</h3>
<p>The Bible in R.</p>
<p>Bibler includes 6 neat datasets about the King James Bible and the Apocrypha.</p>
<h3 id="overview">Overview</h3>
<h4 id="bible">Bible</h4>
<ol style="list-style-type: decimal">
<li><code>king_james_df</code> The King James Bible as data.frame</li>
<li><code>king_james_tm</code> The King James Bible as <a href="https://cran.r-project.org/package=tm">tm</a> corpus (<code>c(&quot;VCorpus&quot;, &quot;Corpus&quot;</code>)</li>
<li><code>king_james_books</code> List of books that constitute the King James Bible</li>
</ol>
<h4 id="apocrypha">Apocrypha</h4>
<ol style="list-style-type: decimal">
<li><code>apocrypha_df</code> The Apocrypha as data.frame</li>
<li><code>apocrypha_tm</code> The Apocrypha as <a href="https://cran.r-project.org/package=tm">tm</a> corpus (<code>c(&quot;VCorpus&quot;, &quot;Corpus&quot;</code>)</li>
<li><code>apocrypha_books</code> List of books that constitute the Apocrypha</li>
</ol>
<h4 id="utils">Utils</h4>
<ol style="list-style-type: decimal">
<li><code>middle_english_stopwords</code> Character vector of Middle English stopwords</li>
<li><code>middle_english_positive</code> Lexicon of positive Middle English terms</li>
<li><code>middle_english_negative</code> Lexicon of negative Middle English terms</li>
</ol>
<h3 id="datasets">Datasets</h3>
<p>Both the <code>data.frame</code> and <code>Corpus</code> (tm) datasets include the following variables:</p>
<ol style="list-style-type: decimal">
<li><code>Book.Abbreviation</code></li>
<li><code>King.James.Bible</code> - book title as in King James Bible</li>
<li><code>Vulgate</code> - book title as in Vulgate</li>
<li><code>Douay.Rheims</code> - book title in Douay Reihms version</li>
<li><code>Full.Title.Auth.V</code> - book title in authorized version</li>
<li><code>Testament</code> - Testament in which book/verse can be found.</li>
<li><code>Book.Number</code> - Order of appearance of books, starting with Genesis #1</li>
<li><code>Verse</code></li>
<li><code>Text</code> - content of verse</li>
</ol>
<p>In the corpus datasets (ending in <code>_tm</code>) each verse makes a document while in the <code>data.frame</code> each row is a verse.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tm)
<span class="kw">length</span>(king_james_tm) ==<span class="st"> </span><span class="kw">nrow</span>(king_james_df)</code></pre></div>
<h4 id="data.frame">data.frame</h4>
<p>The data frames consist of one verse by row, meta-data are variables/columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(king_james_df) <span class="co"># see ?king_james_df</span></code></pre></div>
<pre><code>&gt;  [1] &quot;Book.Abbreviation&quot; &quot;King.James.Bible&quot;  &quot;Vulgate&quot;          
&gt;  [4] &quot;Douay.Rheims&quot;      &quot;Full.Title.Auth.V&quot; &quot;Testament&quot;        
&gt;  [7] &quot;Book.Number&quot;       &quot;Verse&quot;             &quot;Text&quot;</code></pre>
<h4 id="corpus">Corpus</h4>
<p>The <a href="https://cran.r-project.org/package=tm">tm</a> corpus is comprised of 31102 documents, one for each verse and include meta-data (identical to columns in <code>_df</code> dataset).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">meta</span>(king_james_tm[[<span class="dv">1</span>]]) <span class="co"># meta of first verse</span></code></pre></div>
<pre><code>&gt;    id               : 1
&gt;    origin           : http://www.sacred-texts.com/bib/osrc/
&gt;    Verse            : Gen|1|1|
&gt;    King.James.Bible : Genesis
&gt;    Vulgate          : Genesis
&gt;    Douay.Reihms     : Genesis
&gt;    Full.Title.Auth.V: The First Book of Moses, called Genesis
&gt;    Testament        : Old Testament
&gt;    Book.Number      : 1</code></pre>
<h4 id="books">Books</h4>
<p>Reference list of the books included in datasets.</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
Book.Abbreviation
</th>
<th style="text-align:left;">
King.James.Bible
</th>
<th style="text-align:left;">
Vulgate
</th>
<th style="text-align:left;">
Douay.Rheims
</th>
<th style="text-align:left;">
Full.Title.Auth.V
</th>
<th style="text-align:left;">
Testament
</th>
<th style="text-align:right;">
Book.Number
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Gen
</td>
<td style="text-align:left;">
Genesis
</td>
<td style="text-align:left;">
Genesis
</td>
<td style="text-align:left;">
Genesis
</td>
<td style="text-align:left;">
The First Book of Moses, called Genesis
</td>
<td style="text-align:left;">
Old Testament
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Exo
</td>
<td style="text-align:left;">
Exodus
</td>
<td style="text-align:left;">
Exodus
</td>
<td style="text-align:left;">
Exodus
</td>
<td style="text-align:left;">
The Second Book of Moses, called Exodus
</td>
<td style="text-align:left;">
Old Testament
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Lev
</td>
<td style="text-align:left;">
Leviticus
</td>
<td style="text-align:left;">
Leviticus
</td>
<td style="text-align:left;">
Leviticus
</td>
<td style="text-align:left;">
The Third Book of Moses, called Leviticus
</td>
<td style="text-align:left;">
Old Testament
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Num
</td>
<td style="text-align:left;">
Numbers
</td>
<td style="text-align:left;">
Numeri
</td>
<td style="text-align:left;">
Numbers
</td>
<td style="text-align:left;">
The Fourth Book of Moses, called Numbers
</td>
<td style="text-align:left;">
Old Testament
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Deu
</td>
<td style="text-align:left;">
Deuteronomy
</td>
<td style="text-align:left;">
Deuteronomium
</td>
<td style="text-align:left;">
Deuteronomy
</td>
<td style="text-align:left;">
The Fifth Book of Moses, called Deuteronomy
</td>
<td style="text-align:left;">
Old Testament
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
<h3 id="examples">Examples</h3>
<h4 id="term-frequency">Term Frequency</h4>
<p>We can have a look at the most mentioned terms in the Bible. Here I use the <code>king_james_tm</code> dataset which is a corpus of documents from the <a href="https://cran.r-project.org/package=tm">tm</a> package.</p>
<p><code>bibler</code> also comes with a set of 97 Middle English stopwords.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(wordcloud)
<span class="kw">library</span>(tm)
<span class="kw">data</span>(<span class="st">&quot;king_james_tm&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;middle_english_stopwords&quot;</span>) <span class="co"># get middle english stopwords</span>

<span class="co"># clean text</span>
wc &lt;-<span class="st"> </span><span class="kw">tm_map</span>(king_james_tm, tolower) <span class="co"># to lower case</span>
wc &lt;-<span class="st"> </span><span class="kw">tm_map</span>(wc, stripWhitespace)
wc &lt;-<span class="st"> </span><span class="kw">tm_map</span>(wc, removeNumbers) <span class="co"># remove</span>
wc &lt;-<span class="st"> </span><span class="kw">tm_map</span>(wc, removePunctuation) <span class="co"># remove punctuation</span>
wc &lt;-<span class="st"> </span><span class="kw">tm_map</span>(wc, removeWords, <span class="kw">c</span>(<span class="kw">stopwords</span>(<span class="st">&quot;english&quot;</span>), middle_english_stopwords,
                                <span class="st">&quot;lord&quot;</span>, <span class="st">&quot;god&quot;</span>)) <span class="co"># remove stopwords</span>
wc &lt;-<span class="st"> </span><span class="kw">tm_map</span>(wc, PlainTextDocument)

<span class="co"># count term frequency</span>
tdm &lt;-<span class="st"> </span><span class="kw">TermDocumentMatrix</span>(wc, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">minWordLength =</span> <span class="dv">2</span>))
tdm &lt;-<span class="st"> </span><span class="kw">removeSparseTerms</span>(tdm, <span class="fl">0.99</span>) 
tdm &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(tdm)
tdm &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">rowSums</span>(tdm), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)
dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">word =</span> <span class="kw">names</span>(tdm), <span class="dt">freq =</span> tdm)

<span class="co"># wordcloud</span>
<span class="kw">wordcloud</span>(<span class="dt">words =</span> dat$word, <span class="dt">scale =</span> <span class="kw">c</span>(<span class="dv">4</span>, .<span class="dv">3</span>), <span class="dt">freq =</span> dat$freq, <span class="dt">max.words =</span> <span class="dv">100</span>,
          <span class="dt">rot.per =</span> <span class="fl">0.25</span>, 
          <span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;#bce784&quot;</span>, <span class="st">&quot;#5dd39e&quot;</span>, <span class="st">&quot;#348aa7&quot;</span>, <span class="st">&quot;#525174&quot;</span>, <span class="st">&quot;#513b56&quot;</span>))</code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-6-1.png" width="864" /></p>
<h4 id="sentiment-analysis">Sentiment Analysis</h4>
<p>First we can download the well-known Bing Liu lists of positive and negative terms.</p>
<p><a href="http://www.cs.uic.edu/~liub/FBS/opinion-lexicon-English.rar">Download</a> Hu and Liu Lexicons</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># base Bing Liu lexicons</span>
neg &lt;-<span class="st"> </span><span class="kw">readLines</span>(<span class="st">&quot;negative-words.txt&quot;</span>)
neg &lt;-<span class="st"> </span>neg[<span class="dv">36</span>:<span class="kw">length</span>(neg)]
pos &lt;-<span class="st"> </span><span class="kw">readLines</span>(<span class="st">&quot;positive-words.txt&quot;</span>)
pos &lt;-<span class="st"> </span>pos[<span class="dv">36</span>:<span class="kw">length</span>(pos)]</code></pre></div>
<p>However those lexicons are based on Internet reviews and other modernities and therefore are not well suited to the King James Bible. To remedy to this <code>bibler</code> also comes with lexicons of positive and negative Middle English terms.</p>
<ol style="list-style-type: decimal">
<li>48 Positive terms</li>
<li>42 Negative terms</li>
</ol>
<p>We can now assess the sentiment of each verse and plot the average sentiment by book in order of appearance in the Bible.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;king_james_df&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;middle_english_negative&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;middle_english_positive&quot;</span>)
pos &lt;-<span class="st"> </span><span class="kw">c</span>(pos, middle_english_positive)
neg &lt;-<span class="st"> </span><span class="kw">c</span>(neg, middle_english_negative)

<span class="co"># sentiment scoring FUN</span>
sentiment_score =<span class="st"> </span>function(text, pos.words, neg.words){
  scores =<span class="st"> </span>plyr::<span class="kw">laply</span>(text,
                 function(text, pos.words, neg.words){
                   text =<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;[[:punct:]]&quot;</span>, <span class="st">&quot;&quot;</span>, text)
                   text =<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;[[:cntrl:]]&quot;</span>, <span class="st">&quot;&quot;</span>, text)
                   text =<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;</span><span class="ch">\\</span><span class="st">d+&#39;</span>, <span class="st">&#39;&#39;</span>, text)
                   text =<span class="st"> </span><span class="kw">sapply</span>(text, tolower)
                   word_list =<span class="st"> </span>stringr::<span class="kw">str_split</span>(text, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">s+&quot;</span>)
                   words =<span class="st"> </span><span class="kw">unlist</span>(word_list)
                   positive_matches =<span class="st"> </span><span class="kw">match</span>(words, pos.words)
                   negative_matches =<span class="st"> </span><span class="kw">match</span>(words, neg.words)
                   positive_matches =<span class="st"> </span>!<span class="kw">is.na</span>(positive_matches)
                   negative_matches =<span class="st"> </span>!<span class="kw">is.na</span>(negative_matches)
                   score =<span class="st"> </span><span class="kw">sum</span>(positive_matches) -<span class="st"> </span><span class="kw">sum</span>(negative_matches)
                   <span class="kw">return</span>(score)
                 }, pos.words, neg.words)
  <span class="kw">return</span>(scores)
}

<span class="co"># score each verse</span>
king_james_df$Sentiment &lt;-<span class="st"> </span><span class="kw">sentiment_score</span>(king_james_df$Text, pos, neg)

<span class="co"># mean sentiment / book</span>
bks &lt;-<span class="st"> </span>plyr::<span class="kw">ddply</span>(king_james_df, <span class="kw">c</span>(<span class="st">&quot;King.James.Bible&quot;</span>, <span class="st">&quot;Book.Number&quot;</span>),
                                    plyr::summarise, <span class="dt">Sentiment =</span> <span class="kw">mean</span>(Sentiment))

bks$colour &lt;-<span class="st"> </span><span class="kw">ifelse</span>(bks$Sentiment &gt;=<span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;#5dd39e&quot;</span>, <span class="st">&quot;#525174&quot;</span>)
bks$label &lt;-<span class="st"> </span><span class="kw">ifelse</span>(bks$Sentiment &gt;=<span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;positive&quot;</span>, <span class="st">&quot;negative&quot;</span>)
<span class="kw">plot_ly</span>(bks,
        <span class="dt">x =</span> ~Book.Number,
        <span class="dt">y =</span> ~Sentiment,
        <span class="dt">type =</span> <span class="st">&quot;bar&quot;</span>,
        <span class="dt">text =</span> ~King.James.Bible,
        <span class="dt">hoverinfo =</span> <span class="st">&quot;text&quot;</span>,
        <span class="dt">marker =</span> <span class="kw">list</span>(
          <span class="dt">color =</span> ~colour
        ),
         <span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">layout</span>(<span class="dt">title =</span> <span class="st">&quot;Average sentiment by book&quot;</span>,
         <span class="dt">showlegend =</span> <span class="ot">FALSE</span>,
         <span class="dt">xaxis =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&quot;Book Number&quot;</span>))</code></pre></div>
<div id="164353e9e713" style="width:100%;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="164353e9e713">{"x":{"visdat":{"164326981175":["function () ","plotlyVisDat"]},"cur_data":"164326981175","attrs":{"164326981175":{"x":{},"y":{},"text":{},"hoverinfo":"text","marker":{"color":{}},"alpha":1,"sizes":[10,100],"type":"bar"}},"layout":{"width":"100%","margin":{"b":40,"l":60,"t":25,"r":10},"title":"Average sentiment by book","showlegend":false,"xaxis":{"domain":[0,1],"title":"Book Number"},"yaxis":{"domain":[0,1],"title":"Sentiment"},"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[13,46,62,11,60,9,52,54,14,47,63,12,61,10,53,55,64,30,51,27,5,21,49,17,2,26,15,48,1,35,37,58,28,23,59,24,18,29,32,6,65,7,25,3,39,33,34,16,4,31,57,50,20,19,66,45,8,22,43,42,41,40,44,56,38,36],"y":[0.180467091295117,0.091533180778032,0.19047619047619,0.0318627450980392,0.495238095238095,-0.223456790123457,0.382022471910112,0.504424778761062,-0.0231143552311436,0.373540856031128,0.538461538461538,-0.226703755215577,0.245901639344262,-0.142446043165468,0.446808510638298,0.421686746987952,1.35714285714286,-0.417808219178082,0.536842105263158,0.403361344537815,-0.200208550573514,0.00900900900900901,0.52258064516129,0.0419161676646707,0.0733718054410552,-0.398271798900236,0.114285714285714,0.25503355704698,-0.131115459882583,-0.714285714285714,-0.105263157894737,0.386138613861386,-0.411167512690355,-0.256191950464396,0.37962962962963,-0.725806451612903,-0.296261682242991,-0.232876712328767,-0.25,-0.0851063829787234,-0.08,-0.132686084142395,-0.772727272727273,-0.523864959254948,-0.436363636363636,-0.419047619047619,-0.702127659574468,0.00985221674876847,-0.207298136645963,-0.619047619047619,0.72,0.625,-0.149726775956284,0.114181227143438,0.356435643564356,0.163972286374134,0.0823529411764706,0.965811965811966,0.0261660978384528,0.0191138140747176,-0.084070796460177,0.00933706816059757,0.0516385302879841,0.521739130434783,-0.004739336492891,-1.0188679245283],"text":["1 Chronicles","1 Corinthians","1 John","1 Kings","1 Peter","1 Samuel","1 Thessalonians","1 Timothy","2 Chronicles","2 Corinthians","2 John","2 Kings","2 Peter","2 Samuel","2 Thessalonians","2 Timothy","3 John","Amos","Colossians","Daniel","Deuteronomy","Ecclesiastes","Ephesians","Esther","Exodus","Ezekiel","Ezra","Galatians","Genesis","Habakkuk","Haggai","Hebrews","Hosea","Isaiah","James","Jeremiah","Job","Joel","Jonah","Joshua","Jude","Judges","Lamentations","Leviticus","Malachi","Micah","Nahum","Nehemiah","Numbers","Obadiah","Philemon","Philippians","Proverbs","Psalms","Revelation","Romans","Ruth","Song of Solomon","St. John","St. Luke","St. Mark","St. Matthew","The Acts","Titus","Zechariah","Zephaniah"],"hoverinfo":"text","marker":{"fillcolor":"rgba(31,119,180,1)","color":["#5dd39e","#5dd39e","#5dd39e","#5dd39e","#5dd39e","#525174","#5dd39e","#5dd39e","#525174","#5dd39e","#5dd39e","#525174","#5dd39e","#525174","#5dd39e","#5dd39e","#5dd39e","#525174","#5dd39e","#5dd39e","#525174","#5dd39e","#5dd39e","#5dd39e","#5dd39e","#525174","#5dd39e","#5dd39e","#525174","#525174","#525174","#5dd39e","#525174","#525174","#5dd39e","#525174","#525174","#525174","#525174","#525174","#525174","#525174","#525174","#525174","#525174","#525174","#525174","#5dd39e","#525174","#525174","#5dd39e","#5dd39e","#525174","#5dd39e","#5dd39e","#5dd39e","#5dd39e","#5dd39e","#5dd39e","#5dd39e","#525174","#5dd39e","#5dd39e","#5dd39e","#525174","#525174"],"line":{"color":"transparent"}},"type":"bar","xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p>There is indeed more negativity at the “beginning” of the Bible: the Old Testament is far more gruesome than the New Testament.</p>
<p>The <em>Song of Solomon</em> (book #22) is a lapse of light amidst the dark and spine-chilling godly injunctions of the Old Testament, it is scripturally unique in its celebration of sexual love.</p>
<p>John 3 in the New Testament is also positive, by the Bible standard anyway: John accepts Jesus as the Messiah, gets baptised, finds the path to God, etc. Good stuff.</p>
<p>The most negative book according to the analysis is <em>Zephaniah</em> (book #36) which is not inaccurate, the message of the book is best summed by this terse and unambiguous passage:</p>
<blockquote>
<p>“You also, O Ethiopians, / Shall be killed by my sword.”</p>
</blockquote>
<p>Zephaniah comes towards the end of the Old Testament and those who have not accepted the truth by then must be slain.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)

rect &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">xmin =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">39</span>), <span class="dt">xmax =</span> <span class="kw">c</span>(<span class="dv">39</span>, <span class="dv">67</span>), <span class="dt">ymin =</span> <span class="kw">c</span>(-<span class="fl">1.1</span>, -<span class="fl">1.1</span>), 
                   <span class="dt">ymax =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>), 
                   <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;Old Testament&quot;</span>, <span class="st">&quot;New Testament&quot;</span>),
                   <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;#bce784&quot;</span>, <span class="st">&quot;#525174&quot;</span>))

<span class="kw">ggplot</span>(<span class="dt">data =</span> bks, <span class="kw">aes</span>(<span class="dt">x =</span> Book.Number, <span class="dt">y =</span> Sentiment)) +
<span class="st">    </span><span class="kw">geom_rect</span>(<span class="dt">data =</span> rect, 
              <span class="kw">aes</span>(<span class="dt">xmin =</span> xmin, <span class="dt">xmax =</span> xmax, <span class="dt">ymin =</span> ymin, <span class="dt">ymax =</span> ymax, 
                  <span class="dt">fill =</span> fill, <span class="dt">alpha =</span> <span class="fl">0.5</span>),
            <span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>,
            <span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>) +
<span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> rect, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">39</span>/<span class="dv">2</span>, (<span class="dv">39</span>+(<span class="dv">27</span>/<span class="dv">2</span>))), <span class="dt">y =</span> ymax -<span class="st"> </span><span class="fl">0.2</span>, 
                             <span class="dt">label =</span> label),
            <span class="dt">color =</span> <span class="st">&quot;grey20&quot;</span>, <span class="dt">fontface =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>) +
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#5dd39e&quot;</span>, <span class="st">&quot;#525174&quot;</span>)) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,
        <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>(),
        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-10-1.png" width="864" /></p>
<p>Average sentiment:</p>
<ol style="list-style-type: decimal">
<li>Old Testament: -0.156</li>
<li>New Testament: 0.137</li>
</ol>
<h4 id="testaments">Testaments</h4>
<p>Since there are textual differences between Testaments we’ll categorise the verses according to each and plot a comparison cloud.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># split</span>
old &lt;-<span class="st"> </span><span class="kw">paste0</span>(king_james_df[king_james_df$Testament ==<span class="st"> &quot;Old Testament&quot;</span>, <span class="st">&quot;Text&quot;</span>],
              <span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)
new &lt;-<span class="st"> </span><span class="kw">paste0</span>(king_james_df[king_james_df$Testament ==<span class="st"> &quot;New Testament&quot;</span>, <span class="st">&quot;Text&quot;</span>],
              <span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)
corp &lt;-<span class="st"> </span><span class="kw">Corpus</span>(<span class="kw">VectorSource</span>(<span class="kw">c</span>(old, new))) <span class="co"># combine</span>
corp &lt;-<span class="st"> </span><span class="kw">tm_map</span>(corp, removePunctuation)
corp &lt;-<span class="st"> </span><span class="kw">tm_map</span>(corp, <span class="kw">content_transformer</span>(tolower))
corp &lt;-<span class="st"> </span><span class="kw">tm_map</span>(corp, removeNumbers)
corp &lt;-<span class="st"> </span><span class="kw">tm_map</span>(corp, removeWords, <span class="kw">c</span>(middle_english_stopwords, 
                                    <span class="kw">stopwords</span>(<span class="st">&quot;english&quot;</span>)))

term.matrix &lt;-<span class="st"> </span><span class="kw">TermDocumentMatrix</span>(corp)
term.matrix &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(term.matrix)
<span class="kw">colnames</span>(term.matrix) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Old Testament&quot;</span>, <span class="st">&quot;New Testament&quot;</span>)
<span class="kw">comparison.cloud</span>(term.matrix, <span class="dt">max.words =</span> <span class="dv">200</span>, <span class="dt">random.order =</span> <span class="ot">FALSE</span>,
                 <span class="dt">rot.per =</span> <span class="fl">0.25</span>, <span class="dt">colors =</span> <span class="kw">rev</span>(<span class="kw">c</span>(<span class="st">&quot;#5dd39e&quot;</span>, <span class="st">&quot;#525174&quot;</span>)), <span class="dt">title.size =</span> <span class="dv">1</span>, 
                 <span class="dt">scale =</span> <span class="kw">c</span>(<span class="dv">3</span>, .<span class="dv">5</span>))</code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-11-1.png" width="864" /></p>
<p>The New Testament is mostly about Jesus Christ and the band of disciples roaming the lands laying hands. While the Old Testament is more about God appearing to illiterate desert people ruling that <em>thee</em> and <em>thy</em> shall obey.</p>
<h3 id="mary">Mary</h3>
<p>Christopher Hitchens once said that Mary only appeared three times in the bibe. I cannot tell exactly what he meant by “appeared” (only God knows now) but we can tell that she is mentioned far more often - 46 times.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(king_james_df$Text[<span class="kw">grep</span>(<span class="st">&quot;Mary[[:space:]]|Mary[[:punct:]]&quot;</span>, king_james_df$Text)]) <span class="co"># nbr mentions</span></code></pre></div>
</div>
<p></main></p>

<script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script type="text/javascript" src="../../js/materialize.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript" charset="utf-8">
 $('code').each(function(i, inline) {
   hljs.highlightBlock(inline);
 });
 $('pre code').each(function(i, block) {
   hljs.highlightBlock(block);
 });
</script>

<script type="text/javascript" charset="utf-8">
  $("img").addClass("responsive-img");
</script>

<footer class="page-footer blue">
  <div class="container">
    <div class="row">
      <div class="col l6 s12">
        <h5 class="white-text brand">John Coene</h5>
        <p class="grey-text text-lighten-4">Data, limericks, and other indoor stuff.</p>
      </div>
      <div class="col l4 offset-l2 s12">
        <h5 class="white-text">Connect</h5>
        <ul>
          <li><a class="grey-text text-lighten-3" href="https://twitter.com/jdatap">Twitter</a></li>
          <li><a class="grey-text text-lighten-3" href="http://github.com/JohnCoene">Github</a></li>
          <li><a class="grey-text text-lighten-3" href="https://www.linkedin.com/in/johncoene/">LinkedIn</a></li>
        </ul>
      </div>
    </div>
  </div>
  <div class="footer-copyright">
    <div class="container">
    © 2017 John Coene
    <a class="grey-text text-lighten-4 right" href="http://johncoene.github.io/cv/">Resume</a>
    </div>
  </div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
