<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title></title>

<script src="site_libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="site_libs/echarts-2.2.7/echarts-all.js"></script>
<script src="site_libs/echarts-binding-0.0.1/echarts.js"></script>
<meta http-equiv="Cache-control" content="public">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<!--Import materialize.css-->
<link type="text/css" rel="stylesheet" href="../../css/materialize.min.css"  media="screen,projection"/>

<link rel="stylesheet" href="../../css/atelier-cave-light.css">

<!--Let browser know website is optimized for mobile-->
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-74544116-1', 'auto');
  ga('send', 'pageview');

</script>

<!--SHARE TAGS-->
<meta name="google-site-verification" content="p4A9hVd1c8FOAlQsyDq0NMrE9IQdtfZoHgQ2e1t2dYE" />
<meta name="description" content="R, data, and other indoor stuff." />

<!-- Schema.org markup for Google+ -->
<meta itemprop="name" content="John Coene">
<meta itemprop="description" content="R, data, and other indoor stuff.">
<meta itemprop="image" content="http://john-coene.com/img/graphTweets.png">

<!-- Twitter Card data -->
<meta name="twitter:card" content="website">
<meta name="twitter:site" content="@jdatap">
<meta name="twitter:title" content="John Coene">
<meta name="twitter:description" content="R, data, and other indoor stuff.">
<meta name="twitter:creator" content="@jdatap">
<meta name="twitter:image" content="http://john-coene.com/img/graphTweets.png">

<!-- Open Graph data -->
<meta property="og:title" content="John Coene" />
<meta property="og:image" content="http://john-coene.com/img/graphTweets.png" />
<meta property="og:description" content="R, data, and other indoor stuff." />
<meta property="og:site_name" content="John Coene" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #dddddd; }
td.sourceCode { padding-left: 5px; }
code > span.kw { font-weight: bold; } /* Keyword */
code > span.dt { color: #800000; } /* DataType */
code > span.dv { color: #0000ff; } /* DecVal */
code > span.bn { color: #0000ff; } /* BaseN */
code > span.fl { color: #800080; } /* Float */
code > span.ch { color: #ff00ff; } /* Char */
code > span.st { color: #dd0000; } /* String */
code > span.co { color: #808080; font-style: italic; } /* Comment */
code > span.al { color: #00ff00; font-weight: bold; } /* Alert */
code > span.fu { color: #000080; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #ff0000; font-weight: bold; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #ff00ff; } /* SpecialChar */
code > span.vs { color: #dd0000; } /* VerbatimString */
code > span.ss { color: #dd0000; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { font-weight: bold; } /* Preprocessor */
code > span.at { } /* Attribute */
code > span.do { color: #808080; font-style: italic; } /* Documentation */
code > span.an { color: #808080; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #808080; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #808080; font-weight: bold; font-style: italic; } /* Information */
</style>



<link rel="stylesheet" href="../../css/styles.css" type="text/css" />

</head>

<body>


<ul id="dropdown1" class="dropdown-content">
  <li><a class="blue-text" href="https://cran.r-project.org/web/packages/rodham/" target="_blank">CRAN</a></li>
  <li><a class="blue-text" href="https://github.com/JohnCoene/rodham/" target="_blank">Repository</a></li>
  <li><a class="blue-text" href="https://cran.r-project.org/web/packages/rodham/rodham.pdf">Manual</a></li>
  <li><a class="blue-text" href="https://cran.r-project.org/web/packages/rodham/vignettes/how-to.html" target="_blank">Vignette</a></li>
  <li><a class="blue-text" href="examples">Examples</a></li>
</ul>

<nav>
  <div class="nav-wrapper blue">
    <div class="container">
      <a href="http://john-coene.com/" class="brand-logo brand">John Coene</a>
      <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>
      <ul id="nav-mobile" class="right hide-on-med-and-down">
        <li>
          <a class="dropdown-button" href="#!" data-activates="dropdown1">Explore<i class="material-icons right">arrow_drop_down</i></a>
        </li>
      </ul>
      <ul class="side-nav" id="mobile-demo">
        <li><a href="https://cran.r-project.org/web/packages/rodham/" target="_blank">CRAN</a></li>
        <li><a href="https://github.com/JohnCoene/rodham/" target="_blank">Repository</a></li>
        <li><a href="https://cran.r-project.org/web/packages/rodham/rodham.pdf">Manual</a></li>
        <li><a href="https://cran.r-project.org/web/packages/rodham/vignettes/how-to.html" target="_blank">Vignette</a></li>
        <li><a href="examples">Examples</a></li>
      </ul>
    </div>
  </div>
</nav>





<main>
<div class="container">
<h2 id="exploring-the-benghazi-release">Exploring the Benghazi release</h2>
<p><em>This is meant as an example where I merely explore the emails, it is not to be considered as a full-fledged analysis on which one should forge an opinion</em></p>
<h2 id="setup">Setup</h2>
<p>Install and load <code>rodham</code>. Also, for these examples I am using the <code>echarts</code> library for the visualisation as well as <code>dplyr</code> and <code>tidyr</code> for the data manipulation, install and load that too.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages(&quot;rodham&quot;) </span>
<span class="co"># CRAN release</span>
<span class="kw">library</span>(rodham)

<span class="co"># install.packages(&quot;dplyr&quot;)</span>
<span class="kw">library</span>(dplyr)

<span class="co"># install.packages(&quot;tidyr&quot;)</span>
<span class="kw">library</span>(tidyr)

<span class="co"># devtools::install_github(&quot;JohnCoene/echarts&quot;)</span>
<span class="kw">library</span>(echarts)</code></pre></div>
<h2 id="get-the-emails">Get the emails</h2>
<p>Let’s download the Benghazi release to use as example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ext &lt;-<span class="st"> </span><span class="kw">get_xpdf</span>() <span class="co"># get the pdftotext extractor</span>

<span class="kw">download_emails</span>(<span class="st">&quot;Benghazi&quot;</span>) <span class="co"># download</span>

<span class="kw">dir.create</span>(<span class="st">&quot;pdf&quot;</span>) <span class="co"># create directory where to extract pdf emails to</span>

<span class="kw">unzip</span>(<span class="st">&quot;Benghazi.zip&quot;</span>, <span class="dt">exdir =</span> <span class="st">&quot;pdf&quot;</span>)

dir &lt;-<span class="st"> &quot;text&quot;</span> <span class="co"># where we&#39;ll extract txt files to</span>

<span class="kw">dir.create</span>(dir)

<span class="co"># extract emails to created directory</span>
<span class="kw">extract_emails</span>(<span class="st">&quot;pdf&quot;</span>, <span class="dt">save.dir =</span> dir, <span class="dt">ext =</span> ext)

<span class="co"># laod all emails</span>
hrc_emails &lt;-<span class="st"> </span><span class="kw">load_emails</span>(dir)</code></pre></div>
<h2 id="explore">Explore</h2>
<p>Now we can explore the emails. Let’s look at when the emails are received; we can get the date using the <code>get_date</code> method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_date</span>(hrc_emails) %&gt;%<span class="st"> </span><span class="co"># get the dates</span>
<span class="st">  </span><span class="kw">count</span>(dates) %&gt;%<span class="st"> </span><span class="co"># count by dates</span>
<span class="st">  </span><span class="kw">echart</span>(dates, <span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>) %&gt;%<span class="st"> </span><span class="co"># plot</span>
<span class="st">  </span><span class="kw">earea</span>(n, <span class="dt">name =</span> <span class="st">&quot;emails&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etitle</span>(<span class="st">&quot;Benghazi release&quot;</span>, <span class="st">&quot;Number of emails by date&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">emark_point</span>(<span class="st">&quot;emails&quot;</span>, <span class="dt">data =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">type =</span> <span class="st">&quot;max&quot;</span>, <span class="dt">name =</span> <span class="st">&quot;maximum&quot;</span>))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etooltip</span>() %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etoolbox_magic</span>(<span class="dt">type =</span> <span class="kw">list</span>(<span class="st">&quot;line&quot;</span>, <span class="st">&quot;bar&quot;</span>)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ezoom</span>() %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etheme</span>(<span class="st">&quot;helianthus&quot;</span>)</code></pre></div>
<div id="htmlwidget-b67c5cb3e414c9c1b334" style="width:100%;height:480px;" class="echarts html-widget"></div>
<script type="application/json" data-for="htmlwidget-b67c5cb3e414c9c1b334">{"x":{"theme":"helianthus","options":{"xAxis":[{"type":"category","data":["2011-03-03","2011-03-11","2011-03-13","2011-03-23","2011-03-27","2011-03-29","2011-03-30","2011-04-01","2011-04-02","2011-04-03","2011-04-08","2011-04-10","2011-04-22","2011-04-23","2011-04-24","2011-04-26","2011-05-02","2011-05-06","2011-06-03","2011-06-10","2011-08-08","2011-08-21","2011-08-22","2011-09-03","2011-09-10","2011-09-14","2011-10-21","2012-01-05","2012-01-06","2012-01-09","2012-01-12","2012-01-18","2012-01-23","2012-01-24","2012-01-27","2012-02-21","2012-02-22","2012-02-24","2012-02-28","2012-03-09","2012-04-03","2012-04-04","2012-04-05","2012-04-23","2012-04-27","2012-07-04","2012-07-07","2012-07-17","2012-08-23","2012-08-24","2012-08-27","2012-08-28","2012-09-11","2012-09-12","2012-09-13","2012-09-14","2012-09-15","2012-09-16","2012-09-17","2012-09-18","2012-09-19","2012-09-20","2012-09-21","2012-09-22","2012-09-23","2012-09-24","2012-09-25","2012-09-26","2012-09-27","2012-09-28","2012-09-30","2012-10-01","2012-10-03","2012-10-06","2012-10-07","2012-10-08","2012-10-10","2012-10-11","2012-10-12","2012-10-13","2012-10-14","2012-10-15","2012-10-16","2012-10-17","2012-10-18","2012-10-19","2012-10-25","2012-10-27","2012-10-29","2012-11-11","2012-11-13","2012-11-14","2012-11-15","2012-11-16","2012-11-18","2012-11-22","2012-11-23","2012-11-24","2012-11-25","2012-11-26","2012-11-28","2012-12-04","2012-12-10","2012-12-18","2012-12-19","2012-12-20","2012-12-24"]}],"yAxis":[],"series":[{"name":"emails","type":"line","data":[1,2,2,1,2,3,3,1,3,1,3,1,2,2,1,2,2,2,4,1,1,1,5,1,1,1,1,5,1,1,1,1,2,1,1,1,1,1,1,2,2,1,1,1,1,1,3,1,1,2,1,2,6,27,9,13,13,14,3,1,1,2,3,3,8,3,1,1,3,2,2,6,2,2,4,2,5,2,6,1,4,3,1,5,2,2,4,1,1,1,1,5,2,1,2,1,5,1,2,2,2,1,1,2,1,11,1],"smooth":true,"itemStyle":{"normal":{"areaStyle":{"type":"default"}}},"markPoint":{"data":[{"type":"max","name":"maximum"}],"clickable":true,"symbol":"pin","symbolSize":10,"large":false}}],"title":{"show":true,"text":"Benghazi release","subtext":"Number of emails by date","target":"blank","subtarget":"blank","x":"left","y":"top","backgroundColor":"rgba(0,0,0,0)","borderColor":"#ccc","borderWidth":0,"padding":5,"itemGap":5,"zlevel":0,"z":6},"tooltip":{"show":true,"trigger":"axis","zlevel":1,"showContent":true,"islandFormatter":"{a} < br/>{b} : {c}","showDelay":20,"hideDelay":100,"transitionDuration":0.4,"enterable":false,"backgroundColor":"rgba(0,0,0,0.7)","borderColor":"#333","borderRadius":4,"borderWidth":0,"padding":5,"textStyle":{"fontFamily":"Arial, Verdana, sans-serif","fontSize":12,"fontStyle":"normal","fontWeight":"normal"}},"toolbox":{"show":true,"zlevel":0,"z":6,"orient":"horizontal","x":"right","y":"top","backgroundColor":"rgba(0,0,0,0)","borderColor":"#ccc","borderWidth":0,"padding":5,"itemGap":10,"itemSize":16,"color":["#1e90ff","#22bb22","#4b0082","#d2691e"],"disableColor":"#ddd","effectiveColor":"red","showTitle":true,"textStyle":{"fontFamily":"Arial, Verdana, sans-serif","fontSize":12,"fontStyle":"normal","fontWeight":"normal"},"feature":{"magicType":{"show":true,"title":{"line":"line","bar":"bar","stack":"stack","tiled":"tiled","force":"force","chord":"chord","pie":"pie","funnel":"funnel"},"type":["line","bar"]}}},"dataZoom":{"show":true,"zlevel":0,"z":4,"orient":"horizontal","backgroundColor":"rgba(0,0,0,0)","dataBackgroundColor":"#eee","fillerColor":"rgba(144,197,237,0.2)","handleColor":"rgba(70,130,180,0.8)","handleSize":8,"start":0,"end":100,"showDetail":true,"realtime":false,"zoomLock":false}}},"evals":[],"jsHooks":[]}</script>
<p>Already we can see something interesting, the peak on the 12<sup>th</sup> of September 2012. A bit of Googling reveals that this is the very day of the <a href="https://en.wikipedia.org/wiki/2012_Benghazi_attack">Benghazi attack</a> that lead to the death of <a href="https://en.wikipedia.org/wiki/J._Christopher_Stevens">J. Christopher Stevens</a> and the diplomat <a href="https://en.wikipedia.org/wiki/Sean_Smith_(diplomat)">Sean Smith</a>.</p>
<p>Below, you can watch the speech from Hillary Clinton, then Secretary of State, about the killing and given on that very day.</p>
<iframe src="https://www.youtube.com/embed/ljPgIQwaXJ0" width="420" height="315" frameborder="0" allowfullscreen=""></iframe>
<p>Let’s look at the people involved in the email exchanges, shall we? We’ll remove “Hillary Clinton” because we can safely expect that she’ll be the most frequent name in there.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">people &lt;-<span class="st"> </span><span class="kw">get_com</span>(hrc_emails) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(sr, name, from, to) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(name !=<span class="st"> &quot;Hillary Clinton&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(name !=<span class="st"> &quot;&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">count</span>(name, <span class="dt">sort =</span> <span class="ot">TRUE</span>)

people %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">echart</span>(name, <span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ecloud</span>(n, <span class="dt">size =</span> <span class="kw">list</span>(<span class="st">&quot;30%&quot;</span>, <span class="st">&quot;80%&quot;</span>)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etooltip</span>(<span class="dt">trigger =</span> <span class="st">&quot;item&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etitle</span>(<span class="st">&quot;Benghazi release&quot;</span>, <span class="st">&quot;Senders and receivers&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etheme</span>(<span class="st">&quot;helianthus&quot;</span>)</code></pre></div>
<div id="htmlwidget-69880b3e5409676a16f1" style="width:100%;height:480px;" class="echarts html-widget"></div>
<script type="application/json" data-for="htmlwidget-69880b3e5409676a16f1">{"x":{"theme":"helianthus","options":{"series":[{"type":"wordCloud","clickable":true,"center":["50%","50%"],"size":["30%","80%"],"textRotation":[0,90],"autoSize":{"enable":true,"minSize":12},"z":2,"zlevel":0,"tooltip":{"show":true,"trigger":"item","zlevel":1,"showContent":true,"islandFormatter":"{a} < br/>{b} : {c}","showDelay":5,"hideDelay":100,"transitionDuration":4,"enterable":false,"backgroundColor":"rgba(0,0,0,0.7)","borderColor":"#333","borderRadius":4,"borderWidth":0,"padding":5,"textStyle":{"fontFamily":"Arial, Verdana, sans-serif","fontSize":12,"fontStyle":"normal","fontWeight":"normal"}},"data":[{"name":"Jake Sullivan","value":"92"},{"name":"Cheryl Mills","value":"81"},{"name":"Monica Hanley","value":"27"},{"name":"Huma Abedin","value":"15"},{"name":"Robert Russo","value":"15"},{"name":"Sidney Blumenthal","value":"13"},{"name":"Anne-Marie Slaughter","value":" 5"},{"name":"Oscar Flores","value":" 5"},{"name":"Philippe Reines","value":" 5"},{"name":"Daniel Schwerin","value":" 4"},{"name":"Wendy Sherman","value":" 4"},{"name":"Claire Coleman","value":" 3"},{"name":"Lona Valmoro","value":" 3"},{"name":"Thomas Nides","value":" 3"},{"name":"William Burns","value":" 3"},{"name":"Capricia Marshall","value":" 2"},{"name":"Burns Strider","value":" 1"},{"name":"Harold Hongju Koh","value":" 1"},{"name":"Judith McHale","value":" 1"},{"name":"Lauren Jiloty","value":" 1"},{"name":"Maria Otero","value":" 1"},{"name":"Melanne Verveer","value":" 1"},{"name":"Victoria Nuland","value":" 1"}]}],"tooltip":{"show":true,"trigger":"item","zlevel":1,"showContent":true,"islandFormatter":"{a} < br/>{b} : {c}","showDelay":20,"hideDelay":100,"transitionDuration":0.4,"enterable":false,"backgroundColor":"rgba(0,0,0,0.7)","borderColor":"#333","borderRadius":4,"borderWidth":0,"padding":5,"textStyle":{"fontFamily":"Arial, Verdana, sans-serif","fontSize":12,"fontStyle":"normal","fontWeight":"normal"}},"title":{"show":true,"text":"Benghazi release","subtext":"Senders and receivers","target":"blank","subtarget":"blank","x":"left","y":"top","backgroundColor":"rgba(0,0,0,0)","borderColor":"#ccc","borderWidth":0,"padding":5,"itemGap":5,"zlevel":0,"z":6}}},"evals":[],"jsHooks":[]}</script>
<p>We can see 92 mentions of Jake Sullivan, senior policy advisor to Hillary Clinton and 81 mentions of Cheryl Mills, lawyer who defended Bill Clinton during his 1999 impeachment trial, which hints at the situation Clinton found herself in.</p>
<p>Perhaps we could look at the network of emails as this may contain valuable information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># nodes table</span>
nodes &lt;-<span class="st"> </span><span class="kw">get_com</span>(hrc_emails) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(sr, name, from, to) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(name !=<span class="st"> &quot;&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">count</span>(name, <span class="dt">sort =</span> <span class="ot">TRUE</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">as.data.frame</span>(people)

<span class="co"># edge table</span>
edges &lt;-<span class="st"> </span><span class="kw">get_com</span>(hrc_emails) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">to =</span> <span class="kw">as.character</span>(to), 
         <span class="dt">from =</span> <span class="kw">as.character</span>(from)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(from !=<span class="st"> &quot;&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(from, to) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">tally</span>(<span class="dt">sort =</span> <span class="ot">TRUE</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">as.data.frame</span>(edges)

<span class="kw">echart</span>(<span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">eforce</span>(
    <span class="dt">itemStyle =</span> <span class="kw">list</span>()
  ) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">enodes</span>(nodes, 
         name, 
         <span class="dt">value =</span> n) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">elinks</span>(edges, from, to) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etitle</span>(<span class="st">&quot;Benghazi release&quot;</span>, <span class="st">&quot;Network of emails&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etooltip</span>(<span class="dt">trigger =</span> <span class="st">&quot;item&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etheme</span>(<span class="st">&quot;helianthus&quot;</span>)</code></pre></div>
<div id="htmlwidget-5673ea8b60cccc06282c" style="width:100%;height:480px;" class="echarts html-widget"></div>
<script type="application/json" data-for="htmlwidget-5673ea8b60cccc06282c">{"x":{"theme":"helianthus","options":{"series":[{"itemStyle":[],"type":"force","large":false,"center":["50%","50%"],"roam":false,"size":"100%","minRadius":10,"maxRadius":20,"linkSymbol":"none","linkSymbolSize":[10,15],"scaling":1,"gravity":1,"draggable":true,"useWorker":true,"steps":1,"z":2,"zlevel":0,"nodes":[{"name":"Hillary Clinton","value":"285"},{"name":"Jake Sullivan","value":" 92"},{"name":"Cheryl Mills","value":" 81"},{"name":"Monica Hanley","value":" 27"},{"name":"Huma Abedin","value":" 15"},{"name":"Robert Russo","value":" 15"},{"name":"Sidney Blumenthal","value":" 13"},{"name":"Anne-Marie Slaughter","value":"  5"},{"name":"Oscar Flores","value":"  5"},{"name":"Philippe Reines","value":"  5"},{"name":"Daniel Schwerin","value":"  4"},{"name":"Wendy Sherman","value":"  4"},{"name":"Claire Coleman","value":"  3"},{"name":"Lona Valmoro","value":"  3"},{"name":"Thomas Nides","value":"  3"},{"name":"William Burns","value":"  3"},{"name":"Capricia Marshall","value":"  2"},{"name":"Burns Strider","value":"  1"},{"name":"Harold Hongju Koh","value":"  1"},{"name":"Judith McHale","value":"  1"},{"name":"Lauren Jiloty","value":"  1"},{"name":"Maria Otero","value":"  1"},{"name":"Melanne Verveer","value":"  1"},{"name":"Victoria Nuland","value":"  1"}],"links":[{"source":"Cheryl Mills","target":"Hillary Clinton","weight":"1"},{"source":"Jake Sullivan","target":"Hillary Clinton","weight":"1"},{"source":"Hillary Clinton","target":"Jake Sullivan","weight":"1"},{"source":"Hillary Clinton","target":"Monica Hanley","weight":"1"},{"source":"Hillary Clinton","target":"Robert Russo","weight":"1"},{"source":"Sidney Blumenthal","target":"Hillary Clinton","weight":"1"},{"source":"Hillary Clinton","target":"Cheryl Mills","weight":"1"},{"source":"Huma Abedin","target":"Hillary Clinton","weight":"1"},{"source":"Monica Hanley","target":"Hillary Clinton","weight":"1"},{"source":"Hillary Clinton","target":"","weight":"1"},{"source":"Anne-Marie Slaughter","target":"Hillary Clinton","weight":"1"},{"source":"Hillary Clinton","target":"Huma Abedin","weight":"1"},{"source":"Hillary Clinton","target":"Oscar Flores","weight":"1"},{"source":"Claire Coleman","target":"Hillary Clinton","weight":"1"},{"source":"Philippe Reines","target":"Hillary Clinton","weight":"1"},{"source":"Wendy Sherman","target":"Hillary Clinton","weight":"1"},{"source":"Capricia Marshall","target":"Cheryl Mills","weight":"1"},{"source":"Daniel Schwerin","target":"Hillary Clinton","weight":"1"},{"source":"Lona Valmoro","target":"Hillary Clinton","weight":"1"},{"source":"William Burns","target":"Hillary Clinton","weight":"1"},{"source":"Burns Strider","target":"Hillary Clinton","weight":"1"},{"source":"Cheryl Mills","target":"Cheryl Mills","weight":"1"},{"source":"Cheryl Mills","target":"Jake Sullivan","weight":"1"},{"source":"Daniel Schwerin","target":"Jake Sullivan","weight":"1"},{"source":"Harold Hongju Koh","target":"Hillary Clinton","weight":"1"},{"source":"Hillary Clinton","target":"Lauren Jiloty","weight":"1"},{"source":"Hillary Clinton","target":"Lona Valmoro","weight":"1"},{"source":"Hillary Clinton","target":"Thomas Nides","weight":"1"},{"source":"Hillary Clinton","target":"William Burns","weight":"1"},{"source":"Jake Sullivan","target":"Wendy Sherman","weight":"1"},{"source":"Judith McHale","target":"Hillary Clinton","weight":"1"},{"source":"Maria Otero","target":"Hillary Clinton","weight":"1"},{"source":"Melanne Verveer","target":"Hillary Clinton","weight":"1"},{"source":"Monica Hanley","target":"Daniel Schwerin","weight":"1"},{"source":"Monica Hanley","target":"Jake Sullivan","weight":"1"},{"source":"Philippe Reines","target":"Cheryl Mills","weight":"1"},{"source":"Philippe Reines","target":"Thomas Nides","weight":"1"},{"source":"Robert Russo","target":"Hillary Clinton","weight":"1"},{"source":"Thomas Nides","target":"Hillary Clinton","weight":"1"},{"source":"Victoria Nuland","target":"Hillary Clinton","weight":"1"}]}],"title":{"show":true,"text":"Benghazi release","subtext":"Network of emails","target":"blank","subtarget":"blank","x":"left","y":"top","backgroundColor":"rgba(0,0,0,0)","borderColor":"#ccc","borderWidth":0,"padding":5,"itemGap":5,"zlevel":0,"z":6},"tooltip":{"show":true,"trigger":"item","zlevel":1,"showContent":true,"islandFormatter":"{a} < br/>{b} : {c}","showDelay":20,"hideDelay":100,"transitionDuration":0.4,"enterable":false,"backgroundColor":"rgba(0,0,0,0.7)","borderColor":"#333","borderRadius":4,"borderWidth":0,"padding":5,"textStyle":{"fontFamily":"Arial, Verdana, sans-serif","fontSize":12,"fontStyle":"normal","fontWeight":"normal"}}}},"evals":[],"jsHooks":[]}</script>
<p>Now let’s look at the topic of the emails with <code>get_subject</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidytext)

<span class="kw">get_subject</span>(hrc_emails) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">subject =</span> <span class="kw">as.character</span>(subject)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">unnest_tokens</span>(word, subject) %&gt;%<span class="st"> </span><span class="co"># tokenise</span>
<span class="st">  </span><span class="kw">anti_join</span>(stop_words, <span class="dt">by =</span> <span class="st">&quot;word&quot;</span>) %&gt;%<span class="st">  </span><span class="co"># remove stopwords</span>
<span class="st">  </span><span class="kw">count</span>(word, <span class="dt">sort =</span> <span class="ot">TRUE</span>) %&gt;%
<span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span>:<span class="dv">10</span>) %&gt;%<span class="st"> </span><span class="co"># take top 10 terms</span>
<span class="st">  </span><span class="kw">echart</span>(word, <span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ebar</span>(n) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etooltip</span>(<span class="dt">trigger =</span> <span class="st">&quot;item&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etitle</span>(<span class="st">&quot;Benghazi Release&quot;</span>, <span class="st">&quot;10 most mentioned terms in subject&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etheme</span>(<span class="st">&quot;helianthus&quot;</span>)</code></pre></div>
<div id="htmlwidget-22797cea0f2f6e12f848" style="width:100%;height:480px;" class="echarts html-widget"></div>
<script type="application/json" data-for="htmlwidget-22797cea0f2f6e12f848">{"x":{"theme":"helianthus","options":{"xAxis":[{"type":"category","data":["sid","libya","benghazi","intel","libyan","update","stevens","chris","u.s","26"]}],"yAxis":[],"series":[{"name":"n","type":"bar","data":[63,52,31,29,27,15,12,10,10,9],"clickable":true,"xAxisIndex":0,"yAxisIndex":0,"barGap":"100%","barCategory":"20%","legendHoverLink":true,"z":2,"zlevel":0}],"tooltip":{"show":true,"trigger":"item","zlevel":1,"showContent":true,"islandFormatter":"{a} < br/>{b} : {c}","showDelay":20,"hideDelay":100,"transitionDuration":0.4,"enterable":false,"backgroundColor":"rgba(0,0,0,0.7)","borderColor":"#333","borderRadius":4,"borderWidth":0,"padding":5,"textStyle":{"fontFamily":"Arial, Verdana, sans-serif","fontSize":12,"fontStyle":"normal","fontWeight":"normal"}},"title":{"show":true,"text":"Benghazi Release","subtext":"10 most mentioned terms in subject","target":"blank","subtarget":"blank","x":"left","y":"top","backgroundColor":"rgba(0,0,0,0)","borderColor":"#ccc","borderWidth":0,"padding":5,"itemGap":5,"zlevel":0,"z":6}}},"evals":[],"jsHooks":[]}</script>
<p>This reveals that, unsurprisingly, “Libya”, “libyan” and “Benghazi” are some of the most frequent terms in email subjects. However here we come closer to the whole controversy; the—most frequent word—“sid” stands for <a href="https://en.wikipedia.org/wiki/Sidney_Blumenthal">Sydney Blumenthal</a>, a name that came up extremely often during Hillary Clinton’s testimony. The reason for its controversy is that “Sid” is not an official but an informal aide that the Clintons first met 30 years ago.</p>
<blockquote>
<p>“I think they both believe that the role he played in the White House then, especially in crafting political defenses, was important in the president surviving impeachment and staying in office,” –<cite><a href="http://edition.cnn.com/2015/10/22/politics/hillary-clinton-benghazi-sidney-blumenthal/index.html">CNN Politics</a></cite></p>
</blockquote>
<h2 id="content">Content</h2>
<p>Now we can look at the actual content of the emails using <code>get_content</code>. As you may well know text is inherently dirty, <code>rodham</code> comes with a <code>clean_content</code> function that attempts to remove a lot of comments and other unwanted lines from the emails.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">content &lt;-<span class="st"> </span><span class="kw">get_content</span>(hrc_emails) <span class="co"># get content</span>
content &lt;-<span class="st"> </span><span class="kw">clean_content</span>(content) <span class="co"># clean</span>

<span class="co"># print first email</span>
content[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>## [1] &quot;STATE DEPT. - PRODUCED TO HOUSE SELECT BENGHAZI COMM. SUBJECT TO AGREEMENT ON SENSITIVE INFORMATION &amp; REDACTIONS. NO FOIA WAIVER.&quot;                                         
## [2] &quot;Sullivan, Jacob J &lt;Sullivan11@state.gov&gt; Wednesday, September 12, 2012 10:16 AM&quot;                                                                                           
## [3] &quot;FW: Wow&quot;                                                                                                                                                                   
## [4] &quot;From: Brose, Christian (Armed Services) (mailto:Christian_Brose@armed-servic,essenate.govi Sent: Wednesday, September 12, 2012 10:09 AM To: Sullivan, Jacob J Subject: Wow&quot;
## [5] &quot;What a wonderful, strong and moving statement by your boss. please tell her how much Sen. McCain appreciated it. Me too&quot;                                                   
## [6] &quot;STATE DEPT. - PRODUCED TO HOUSE SELECT BENGHAZI COMM. SUBJECT TO AGREEMENT ON SENSITIVE INFORMATION &amp; REDACTIONS. NO FOIA WAIVER.&quot;                                         
## [7] &quot;STATE-5CB0045247&quot;</code></pre>
<p>Thankfully the <a href="http://tidytextmining.com">tidytext</a> package by Julia Silge makes mining text in R much more convenient. We can use the <code>tidy_emails</code> to convert the email content into a tidy tibble.</p>
<p><strong>NB:</strong> This is not on v0.1.1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">content &lt;-<span class="st"> </span><span class="kw">tidy_emails</span>(content)
content</code></pre></div>
<pre><code>## # A tibble: 10,381 x 2
##       emails
##        &lt;chr&gt;
##  1 C05739545
##  2 C05739545
##  3 C05739545
##  4 C05739545
##  5 C05739545
##  6 C05739545
##  7 C05739545
##  8 C05739546
##  9 C05739546
## 10 C05739546
## # ... with 10,371 more rows, and 1 more variables: content &lt;chr&gt;</code></pre>
<p>In the first column you will find the document ID (<code>emails</code>) and in the second column (<code>content</code>) you will find each line of text.</p>
<p>Though it may not hold crucial information, I’m curious to see how long Hillary’s emails are, I tend to keep mine (too) short. Plus it’s a nice easy way to introduce the content of the emails.</p>
<blockquote>
<p>“OK”</p>
<p>“Best,”</p>
<p>“John”</p>
</blockquote>
<p>So I’m at an average of 3 words per email, let’s see about Hillary’s.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nwords &lt;-<span class="st"> </span>content %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">inner_join</span>(<span class="kw">get_com</span>(hrc_emails)) %&gt;%<span class="st">  </span><span class="co"># add sender&#39;s and receiver to</span>
<span class="st">  </span><span class="kw">filter</span>(from ==<span class="st"> &quot;Hillary Clinton&quot;</span>) %&gt;%<span class="st">  </span><span class="co"># filter only those sent by Hillary</span>
<span class="st">  </span><span class="kw">group_by</span>(emails) %&gt;%<span class="st"> </span><span class="co"># group by emails to</span>
<span class="st">  </span><span class="kw">count</span>(<span class="dt">sort =</span> <span class="ot">TRUE</span>) %&gt;%<span class="st"> </span><span class="co"># count number of words in each</span>
<span class="st">  </span><span class="kw">ungroup</span>() 

nwords %&gt;%<span class="st">   </span>
<span class="st">  </span><span class="kw">echart</span>(emails, <span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>) %&gt;%<span class="st"> </span><span class="co"># plot</span>
<span class="st">  </span><span class="kw">earea</span>(n) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">emark_line</span>(<span class="dt">data =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">type =</span> <span class="st">&quot;average&quot;</span>, <span class="dt">name =</span> <span class="st">&quot;average&quot;</span>))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">exAxis_category</span>(<span class="dt">boundaryGap =</span> <span class="ot">FALSE</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etitle</span>(<span class="st">&quot;Benghazi release&quot;</span>, <span class="st">&quot;Word per emails&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etooltip</span>() %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etheme</span>(<span class="st">&quot;helianthus&quot;</span>)</code></pre></div>
<div id="htmlwidget-3c623c3f3574d4af93b6" style="width:100%;height:480px;" class="echarts html-widget"></div>
<script type="application/json" data-for="htmlwidget-3c623c3f3574d4af93b6">{"x":{"theme":"helianthus","options":{"xAxis":[{"data":["C05739610","C05739823","C05739722","C05739647","C05739644","C05739660","C05739817","C05739754","C05739775","C05739794","C05739813","C05739864","C05739689","C05739729","C05739688","C05739747","C05739554","C05739769","C05739834","C05739680","C05739718","C05739880","C05739733","C05739750","C05739561","C05739885","C05739833","C05739798","C05739640","C05739667","C05739633","C05739656","C05739711","C05739861","C05739755","C05739824","C05739771","C05739870","C05739578","C05739699","C05739580","C05739638","C05739869","C05739583","C05739696","C05739796","C05739805","C05739618","C05739715","C05739744","C05739888","C05739627","C05739785","C05739891","C05739892","C05739701","C05739865","C05739860","C05739745","C05739778","C05739678","C05739595","C05739652","C05739741","C05739797","C05739882","C05739559","C05739611","C05739693","C05739695","C05739617","C05739740","C05739791","C05739793","C05739853","C05739579","C05739664","C05739856","C05739858","C05739781","C05739788","C05739708","C05739790","C05739849","C05739899","C05739682","C05739894","C05739763","C05739897"],"type":"category","show":true,"zlevel":0,"z":0,"boundaryGap":false}],"yAxis":[],"series":[{"name":"n","type":"line","data":[263,93,84,81,80,78,77,74,74,66,65,65,60,60,59,58,57,55,55,54,53,53,52,52,51,51,50,49,48,47,45,45,45,43,42,42,39,38,37,37,36,36,36,35,35,34,33,31,31,30,28,26,26,26,26,25,24,21,20,20,17,16,16,16,16,16,15,15,15,15,14,14,14,14,13,12,11,11,11,10,10,9,9,9,9,8,7,6,5],"smooth":true,"itemStyle":{"normal":{"areaStyle":{"type":"default"}}},"markLine":{"data":[{"type":"average","name":"average"}],"clickable":true,"symbol":["circle","arrow"],"symbolSize":[2,4],"large":false,"smooth":false,"precision":2,"bundling":{"enable":false,"maxTurningAngle":45}}}],"title":{"show":true,"text":"Benghazi release","subtext":"Word per emails","target":"blank","subtarget":"blank","x":"left","y":"top","backgroundColor":"rgba(0,0,0,0)","borderColor":"#ccc","borderWidth":0,"padding":5,"itemGap":5,"zlevel":0,"z":6},"tooltip":{"show":true,"trigger":"axis","zlevel":1,"showContent":true,"islandFormatter":"{a} < br/>{b} : {c}","showDelay":20,"hideDelay":100,"transitionDuration":0.4,"enterable":false,"backgroundColor":"rgba(0,0,0,0.7)","borderColor":"#333","borderRadius":4,"borderWidth":0,"padding":5,"textStyle":{"fontFamily":"Arial, Verdana, sans-serif","fontSize":12,"fontStyle":"normal","fontWeight":"normal"}}}},"evals":[],"jsHooks":[]}</script>
<p>Hers are much longer than mine, which is rather good news if you ask me. There seems to an email in the tail with 263 words in it and pulls the average up (median = 35), so let’s look at the distribution.</p>
<h3 id="sentiment">Sentiment</h3>
<p>Let’s look at the overall sentiment using the <code>nrc</code> lexicon to look into emotions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidytext)

content %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">unnest_tokens</span>(word, content) %&gt;%<span class="st"> </span><span class="co"># tokenise</span>
<span class="st">  </span><span class="kw">inner_join</span>(<span class="kw">get_sentiments</span>(<span class="st">&quot;nrc&quot;</span>)) %&gt;%<span class="st"> </span><span class="co"># merge with NRC lexicon</span>
<span class="st">  </span><span class="kw">count</span>(sentiment, <span class="dt">sort =</span> <span class="ot">TRUE</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">percent =</span> n/<span class="kw">sum</span>(n),
         <span class="dt">percent =</span> <span class="kw">round</span>(percent, <span class="dv">2</span>) *<span class="st"> </span><span class="dv">100</span>) %&gt;%<span class="st"> </span><span class="co"># counts to percent</span>
<span class="st">  </span><span class="kw">echart</span>(sentiment, <span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>) %&gt;%<span class="st"> </span><span class="co"># plot</span>
<span class="st">  </span><span class="kw">epie</span>(percent, <span class="dt">roseType =</span> <span class="st">&quot;radius&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etooltip</span>(<span class="dt">trigger =</span> <span class="st">&quot;item&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etheme</span>(<span class="st">&quot;helianthus&quot;</span>)</code></pre></div>
<div id="htmlwidget-4c2c5f9ddba42d56d6d1" style="width:100%;height:480px;" class="echarts html-widget"></div>
<script type="application/json" data-for="htmlwidget-4c2c5f9ddba42d56d6d1">{"x":{"theme":"helianthus","options":{"series":[{"name":"percent","type":"pie","data":[{"name":"positive","value":"27"},{"name":"trust","value":"17"},{"name":"negative","value":"16"},{"name":"fear","value":"10"},{"name":"anticipation","value":" 8"},{"name":"anger","value":" 6"},{"name":"sadness","value":" 5"},{"name":"joy","value":" 5"},{"name":"surprise","value":" 3"},{"name":"disgust","value":" 2"}],"clickable":true,"legendHoverLink":true,"center":["50%","50%"],"radius":[0,"75%"],"startAngle":90,"minAngle":0,"clockWise":true,"roseType":"radius","selectedOffset":10,"selectedMode":true,"z":2,"zlevel":0}],"legend":{"data":["positive","trust","negative","fear","anticipation","anger","sadness","joy","surprise","disgust"]},"tooltip":{"show":true,"trigger":"item","zlevel":1,"showContent":true,"islandFormatter":"{a} < br/>{b} : {c}","showDelay":20,"hideDelay":100,"transitionDuration":0.4,"enterable":false,"backgroundColor":"rgba(0,0,0,0.7)","borderColor":"#333","borderRadius":4,"borderWidth":0,"padding":5,"textStyle":{"fontFamily":"Arial, Verdana, sans-serif","fontSize":12,"fontStyle":"normal","fontWeight":"normal"}}}},"evals":[],"jsHooks":[]}</script>
<p>How about we use the afinnity lexicon to look at sentiment over time. On the plot below I also show the highest and lowest days along with the average.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">content %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">inner_join</span>(<span class="kw">get_date</span>(hrc_emails)) %&gt;%<span class="st"> </span><span class="co"># add dates</span>
<span class="st">  </span><span class="kw">unnest_tokens</span>(word, content) %&gt;%<span class="st"> </span><span class="co"># tokenise</span>
<span class="st">  </span><span class="kw">inner_join</span>(<span class="kw">get_sentiments</span>(<span class="st">&quot;afinn&quot;</span>)) %&gt;%<span class="st"> </span><span class="co"># merge with NRC lexicon</span>
<span class="st">  </span><span class="kw">group_by</span>(dates) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">score =</span> <span class="kw">sum</span>(score)) %&gt;%<span class="st"> </span><span class="co"># sum sentiment / day</span>
<span class="st">  </span><span class="kw">echart</span>(dates, <span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>) %&gt;%<span class="st"> </span><span class="co"># plot</span>
<span class="st">  </span><span class="kw">ebar</span>(score) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">emark_point</span>(
    <span class="dt">data =</span> <span class="kw">list</span>(
      <span class="kw">list</span>(<span class="dt">type =</span> <span class="st">&quot;max&quot;</span>, <span class="dt">name =</span> <span class="st">&quot;maximum&quot;</span>), 
      <span class="kw">list</span>(<span class="dt">type =</span> <span class="st">&quot;min&quot;</span>, <span class="dt">name =</span> <span class="st">&quot;minimum&quot;</span>)
      )) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">emark_line</span>(<span class="dt">data =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">type =</span> <span class="st">&quot;average&quot;</span>, <span class="dt">name =</span> <span class="st">&quot;average&quot;</span>))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etooltip</span>(<span class="dt">trigger =</span> <span class="st">&quot;item&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ezoom</span>() %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etitle</span>(<span class="st">&quot;Benghazi release&quot;</span>, <span class="st">&quot;Sentiment over time&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etheme</span>(<span class="st">&quot;helianthus&quot;</span>)</code></pre></div>
<div id="htmlwidget-a540d0dffae4c6e28d57" style="width:100%;height:480px;" class="echarts html-widget"></div>
<script type="application/json" data-for="htmlwidget-a540d0dffae4c6e28d57">{"x":{"theme":"helianthus","options":{"xAxis":[{"type":"category","data":["2011-03-03","2011-03-11","2011-03-13","2011-03-23","2011-03-27","2011-03-29","2011-03-30","2011-04-01","2011-04-02","2011-04-03","2011-04-08","2011-04-10","2011-04-22","2011-04-23","2011-04-24","2011-04-26","2011-05-02","2011-05-06","2011-06-03","2011-06-10","2011-08-08","2011-08-21","2011-08-22","2011-09-03","2011-09-10","2011-09-14","2011-10-21","2012-01-05","2012-01-06","2012-01-09","2012-01-12","2012-01-18","2012-01-23","2012-01-24","2012-01-27","2012-02-21","2012-02-22","2012-02-24","2012-02-28","2012-03-09","2012-04-03","2012-04-04","2012-04-05","2012-04-23","2012-04-27","2012-07-04","2012-07-07","2012-07-17","2012-08-23","2012-08-24","2012-08-27","2012-08-28","2012-09-11","2012-09-12","2012-09-13","2012-09-14","2012-09-15","2012-09-16","2012-09-17","2012-09-18","2012-09-19","2012-09-20","2012-09-21","2012-09-22","2012-09-23","2012-09-24","2012-09-25","2012-09-26","2012-09-27","2012-09-28","2012-09-30","2012-10-01","2012-10-03","2012-10-06","2012-10-07","2012-10-08","2012-10-10","2012-10-11","2012-10-12","2012-10-13","2012-10-14","2012-10-15","2012-10-16","2012-10-17","2012-10-18","2012-10-19","2012-10-25","2012-10-27","2012-10-29","2012-11-11","2012-11-13","2012-11-14","2012-11-15","2012-11-16","2012-11-18","2012-11-22","2012-11-23","2012-11-24","2012-11-25","2012-11-26","2012-11-28","2012-12-04","2012-12-10","2012-12-18","2012-12-19","2012-12-20","2012-12-24"]}],"yAxis":[],"series":[{"name":"score","type":"bar","data":[5,6,38,0,-11,3,7,-2,18,13,185,1,38,42,-4,-26,-25,-21,5,-2,1,9,-30,21,0,15,31,-122,-16,-30,-28,8,-141,-42,-58,-72,-40,-47,-45,-1,103,19,48,14,1,44,-38,42,-2,14,89,90,-3,-98,-186,-56,27,76,-15,13,25,-116,-42,-93,28,526,0,-3,-49,1,488,5,-26,33,151,-47,-9,495,11,18,-59,32,20,39,-29,-2,19,-21,13,-14,0,10,-15,-50,-49,-27,61,10,12,41,-9,-22,72,-23,-36,67,60],"clickable":true,"xAxisIndex":0,"yAxisIndex":0,"barGap":"100%","barCategory":"20%","legendHoverLink":true,"z":2,"zlevel":0,"markPoint":{"data":[{"type":"max","name":"maximum"},{"type":"min","name":"minimum"}],"clickable":true,"symbol":"pin","symbolSize":10,"large":false},"markLine":{"data":[{"type":"average","name":"average"}],"clickable":true,"symbol":["circle","arrow"],"symbolSize":[2,4],"large":false,"smooth":false,"precision":2,"bundling":{"enable":false,"maxTurningAngle":45}}}],"tooltip":{"show":true,"trigger":"item","zlevel":1,"showContent":true,"islandFormatter":"{a} < br/>{b} : {c}","showDelay":20,"hideDelay":100,"transitionDuration":0.4,"enterable":false,"backgroundColor":"rgba(0,0,0,0.7)","borderColor":"#333","borderRadius":4,"borderWidth":0,"padding":5,"textStyle":{"fontFamily":"Arial, Verdana, sans-serif","fontSize":12,"fontStyle":"normal","fontWeight":"normal"}},"dataZoom":{"show":true,"zlevel":0,"z":4,"orient":"horizontal","backgroundColor":"rgba(0,0,0,0)","dataBackgroundColor":"#eee","fillerColor":"rgba(144,197,237,0.2)","handleColor":"rgba(70,130,180,0.8)","handleSize":8,"start":0,"end":100,"showDetail":true,"realtime":false,"zoomLock":false},"title":{"show":true,"text":"Benghazi release","subtext":"Sentiment over time","target":"blank","subtarget":"blank","x":"left","y":"top","backgroundColor":"rgba(0,0,0,0)","borderColor":"#ccc","borderWidth":0,"padding":5,"itemGap":5,"zlevel":0,"z":6}}},"evals":[],"jsHooks":[]}</script>
<h2 id="tf-idf">TF-IDF</h2>
<p>We previously already look at word frequencies, however this is often not very insightful; the most frequent terms are just as useless at the least frequent. What we actually want to is not to look at term frequency, we would like to extract the most characteristic terms from each emails. The latter will cary much more information.</p>
<p>Term frequency-inverse document frequency actual remedies to that to a great example, the simple fact that you do not have to remove stop words demonstrates that very quality.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># count frequency of each word for each emails</span>
content %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">unnest_tokens</span>(word, content) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">count</span>(emails, word, <span class="dt">sort =</span> <span class="ot">TRUE</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ungroup</span>() -&gt;<span class="st"> </span>words_email

<span class="co"># get tfidf</span>
words_email %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">bind_tf_idf</span>(word, emails, n ) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(tf_idf)) -&gt;<span class="st"> </span>tfidf

tfidf %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">top_n</span>(<span class="dv">20</span>) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">tf_idf =</span> <span class="kw">round</span>(tf_idf, <span class="dv">4</span>)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">echart</span>(word, <span class="dt">width =</span> <span class="st">&quot;100%&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ebar</span>(tf_idf) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etitle</span>(<span class="st">&quot;Benghazi release&quot;</span>, <span class="st">&quot;tf-idf&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etooltip</span>(<span class="dt">trigger =</span> <span class="st">&quot;item&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">etheme</span>(<span class="st">&quot;helianthus&quot;</span>)</code></pre></div>
<div id="htmlwidget-eacedd755f81b14e7e9a" style="width:100%;height:480px;" class="echarts html-widget"></div>
<script type="application/json" data-for="htmlwidget-eacedd755f81b14e7e9a">{"x":{"theme":"helianthus","options":{"xAxis":[{"type":"category","data":["state.goy","maria","quad","anne","photo","judith","riots","breaking","panel","breaking","politico","cites","visas","younis","vinograd","wing","wow","proposed","dempsey","visas"]}],"yAxis":[],"series":[{"name":"tf_idf","type":"bar","data":[0.1793,0.1559,0.1369,0.1342,0.1337,0.1265,0.1249,0.1242,0.1239,0.1189,0.1145,0.1138,0.1134,0.1122,0.1116,0.1076,0.1041,0.1035,0.102,0.0995],"clickable":true,"xAxisIndex":0,"yAxisIndex":0,"barGap":"100%","barCategory":"20%","legendHoverLink":true,"z":2,"zlevel":0}],"title":{"show":true,"text":"Benghazi release","subtext":"tf-idf","target":"blank","subtarget":"blank","x":"left","y":"top","backgroundColor":"rgba(0,0,0,0)","borderColor":"#ccc","borderWidth":0,"padding":5,"itemGap":5,"zlevel":0,"z":6},"tooltip":{"show":true,"trigger":"item","zlevel":1,"showContent":true,"islandFormatter":"{a} < br/>{b} : {c}","showDelay":20,"hideDelay":100,"transitionDuration":0.4,"enterable":false,"backgroundColor":"rgba(0,0,0,0.7)","borderColor":"#333","borderRadius":4,"borderWidth":0,"padding":5,"textStyle":{"fontFamily":"Arial, Verdana, sans-serif","fontSize":12,"fontStyle":"normal","fontWeight":"normal"}}}},"evals":[],"jsHooks":[]}</script>
<p>I suspect the term “breaking” appears in emails from the day of the attacks:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tfidf %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">top_n</span>(<span class="dv">20</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;^breaking$&quot;</span>, word)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">inner_join</span>(<span class="kw">get_date</span>(hrc_emails)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(emails, word, dates)</code></pre></div>
<pre><code>## # A tibble: 2 x 3
##      emails     word      dates
##       &lt;chr&gt;    &lt;chr&gt;     &lt;date&gt;
## 1 C05739797 breaking 2012-11-14
## 2 C05739795 breaking 2012-11-14</code></pre>
<p>Wrong, they all pre-date the event.</p>
<p><strong>Thanks for reading folks!</strong> In hope this can get you started, please post your suggestions or issues with the package <a href="https://github.com/JohnCoene/rodham/issues">here</a></p>
</div>
<p></main></p>

<script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script type="text/javascript" src="../../js/materialize.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript" charset="utf-8">
 $('code').each(function(i, inline) {
   hljs.highlightBlock(inline);
 });
 $('pre code').each(function(i, block) {
   hljs.highlightBlock(block);
 });
</script>

<script type="text/javascript" charset="utf-8">
  $(".dropdown-button").dropdown();
  $(".button-collapse").sideNav();
</script>

<footer class="page-footer blue">
  <div class="container">
    <div class="row">
      <div class="col l6 s12">
        <h5 class="white-text brand">John Coene</h5>
        <p class="grey-text text-lighten-4">Data, limericks, and other indoor stuff.</p>
      </div>
      <div class="col l4 offset-l2 s12">
        <h5 class="white-text">Connect</h5>
        <ul>
          <li><a class="grey-text text-lighten-3" href="https://twitter.com/jdatap">Twitter</a></li>
          <li><a class="grey-text text-lighten-3" href="http://github.com/JohnCoene">Github</a></li>
          <li><a class="grey-text text-lighten-3" href="https://www.linkedin.com/in/johncoene/">LinkedIn</a></li>
        </ul>
      </div>
    </div>
  </div>
  <div class="footer-copyright">
    <div class="container">
    © 2017 John Coene
    <a class="grey-text text-lighten-4 right" href="http://johncoene.github.io/cv/">Resume</a>
    </div>
  </div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
